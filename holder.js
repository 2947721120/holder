/*!

Holder - client side image placeholders
Version 2.4.0+avorz
Â© 2014 Ivan Malopinsky - http://imsky.co

Site:		http://imsky.github.io/holder
Issues:		https://github.com/imsky/holder/issues
License:	http://opensource.org/licenses/MIT

*/
!function(e,t,n){t[e]=n}("onDomReady",this,function(e){"use strict";function t(e){if(!w){if(!a.body)return i(t);for(w=!0;e=S.shift();)i(e)}}function n(e){(y||e.type===u||a[h]===c)&&(r(),t())}function r(){y?(a[x](p,n,l),e[x](u,n,l)):(a[g](v,n),e[g](d,n))}function i(e,t){setTimeout(e,+t>=0?t:1)}function o(e){w?i(e):S.push(e)}null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function A(){document.removeEventListener("DOMContentLoaded",A,!1),document.readyState="complete"},!1),document.readyState="loading");var a=e.document,s=a.documentElement,u="load",l=!1,d="on"+u,c="complete",h="readyState",f="attachEvent",g="detachEvent",m="addEventListener",p="DOMContentLoaded",v="onreadystatechange",x="removeEventListener",y=m in a,b=l,w=l,S=[];if(a[h]===c)i(t);else if(y)a[m](p,n,l),e[m](u,n,l);else{a[f](v,n),e[f](d,n);try{b=null==e.frameElement&&s}catch(C){}b&&b.doScroll&&!function E(){if(!w){try{b.doScroll("left")}catch(e){return i(E,50)}r(),t()}}()}return o.version="1.4.0",o.isReady=function(){return w},o}(this)),document.querySelectorAll||(document.querySelectorAll=function(e){var t,n=document.createElement("style"),r=[];for(document.documentElement.firstChild.appendChild(n),document._qsa=[],n.styleSheet.cssText=e+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),n.parentNode.removeChild(n);document._qsa.length;)t=document._qsa.shift(),t.style.removeAttribute("x-qsa"),r.push(t);return document._qsa=null,r}),document.querySelector||(document.querySelector=function(e){var t=document.querySelectorAll(e);return t.length?t[0]:null}),document.getElementsByClassName||(document.getElementsByClassName=function(e){return e=String(e).replace(/^|\s+/g,"."),document.querySelectorAll(e)}),function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.atob=e.atob||function(e){e=String(e);var n,r=0,i=[],o=0,a=0;if(e=e.replace(/\s/g,""),e.length%4===0&&(e=e.replace(/=+$/,"")),e.length%4===1)throw Error("InvalidCharacterError");if(/[^+/0-9A-Za-z]/.test(e))throw Error("InvalidCharacterError");for(;r<e.length;)n=t.indexOf(e.charAt(r)),o=o<<6|n,a+=6,24===a&&(i.push(String.fromCharCode(o>>16&255)),i.push(String.fromCharCode(o>>8&255)),i.push(String.fromCharCode(255&o)),a=0,o=0),r+=1;return 12===a?(o>>=4,i.push(String.fromCharCode(255&o))):18===a&&(o>>=2,i.push(String.fromCharCode(o>>8&255)),i.push(String.fromCharCode(255&o))),i.join("")},e.btoa=e.btoa||function(e){e=String(e);var n,r,i,o,a,s,u,l=0,d=[];if(/[^\x00-\xFF]/.test(e))throw Error("InvalidCharacterError");for(;l<e.length;)n=e.charCodeAt(l++),r=e.charCodeAt(l++),i=e.charCodeAt(l++),o=n>>2,a=(3&n)<<4|r>>4,s=(15&r)<<2|i>>6,u=63&i,l===e.length+2?(s=64,u=64):l===e.length+1&&(u=64),d.push(t.charAt(o),t.charAt(a),t.charAt(s),t.charAt(u));return d.join("")}}(this),function(){function e(t,n,r){t.document;var i,o=t.currentStyle[n].match(/([\d\.]+)(%|cm|em|in|mm|pc|pt|)/)||[0,0,""],a=o[1],s=o[2];return r=r?/%|em/.test(s)&&t.parentElement?e(t.parentElement,"fontSize",null):16:r,i="fontSize"==n?r:/width/i.test(n)?t.clientWidth:t.clientHeight,"%"==s?a/100*i:"cm"==s?.3937*a*96:"em"==s?a*r:"in"==s?96*a:"mm"==s?.3937*a*96/10:"pc"==s?12*a*96/72:"pt"==s?96*a/72:a}function t(e,t){var n="border"==t?"Width":"",r=t+"Top"+n,i=t+"Right"+n,o=t+"Bottom"+n,a=t+"Left"+n;e[t]=(e[r]==e[i]&&e[r]==e[o]&&e[r]==e[a]?[e[r]]:e[r]==e[o]&&e[a]==e[i]?[e[r],e[i]]:e[a]==e[i]?[e[r],e[i],e[o]]:[e[r],e[i],e[o],e[a]]).join(" ")}function n(n){var r,i=this,o=n.currentStyle,a=e(n,"fontSize"),s=function(e){return"-"+e.toLowerCase()};for(r in o)if(Array.prototype.push.call(i,"styleFloat"==r?"float":r.replace(/[A-Z]/,s)),"width"==r)i[r]=n.offsetWidth+"px";else if("height"==r)i[r]=n.offsetHeight+"px";else if("styleFloat"==r)i.float=o[r];else if(/margin.|padding.|border.+W/.test(r)&&"auto"!=i[r])i[r]=Math.round(e(n,r,a))+"px";else if(/^outline/.test(r))try{i[r]=o[r]}catch(u){i.outlineColor=o.color,i.outlineStyle=i.outlineStyle||"none",i.outlineWidth=i.outlineWidth||"0px",i.outline=[i.outlineColor,i.outlineWidth,i.outlineStyle].join(" ")}else i[r]=o[r];t(i,"margin"),t(i,"padding"),t(i,"border"),i.fontSize=Math.round(a)+"px"}window.getComputedStyle||(n.prototype={constructor:n,getPropertyPriority:function(){throw new Error("NotSupportedError: DOM Exception 9")},getPropertyValue:function(e){return this[e.replace(/-\w/g,function(e){return e[1].toUpperCase()})]},item:function(e){return this[e]},removeProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},setProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},getPropertyCSSValue:function(){throw new Error("NotSupportedError: DOM Exception 9")}},window.getComputedStyle=Window.prototype.getComputedStyle=function(e){return new n(e)})}(),Object.prototype.hasOwnProperty||(Object.prototype.hasOwnProperty=function(e){var t=this.__proto__||this.constructor.prototype;return e in this&&(!(e in t)||t[e]!==this[e])}),function(e,t){e.augment=t()}(this,function(){"use strict";var e=function(){},t=Array.prototype.slice,n=function(n,r){var i=e.prototype="function"==typeof n?n.prototype:n,o=new e,a=r.apply(o,t.call(arguments,2).concat(i));if("object"==typeof a)for(var s in a)o[s]=a[s];if(!o.hasOwnProperty("constructor"))return o;var u=o.constructor;return u.prototype=o,u};return n.defclass=function(e){var t=e.constructor;return t.prototype=e,t},n.extend=function(e,t){return n(e,function(e){return this.uber=e,t})},n}),function(e,t){function n(e,t,n,i){var a=r(n.substr(n.lastIndexOf(e.domain)+e.domain.length+1).split("/"),e);a&&o(a.fluid?"fluid":"image",i,a,n,t)}function r(e,t){for(var n={theme:d(m.settings.themes.gray,{})},r=!1,i=e.length,o=0;i>o;o++){var a=e[o];if(m.flags.dimensions.match(a))r=!0,n.dimensions=m.flags.dimensions.output(a);else if(m.flags.fluid.match(a))r=!0,n.dimensions=m.flags.fluid.output(a),n.fluid=!0;else if(m.flags.textmode.match(a))n.textmode=m.flags.textmode.output(a);else if(m.flags.colors.match(a)){var s=m.flags.colors.output(a);n.theme=d(n.theme,s)}else t.themes[a]?t.themes.hasOwnProperty(a)&&(n.theme=d(t.themes[a],{})):m.flags.font.match(a)?n.font=m.flags.font.output(a):m.flags.auto.match(a)?n.auto=!0:m.flags.text.match(a)&&(n.text=m.flags.text.output(a))}return r?n:!1}function i(e,t,n,r){var i=null,o=t.dimensions,a=t.theme,s=t.flags,u=o.width,d=o.height,c=l(u,d,a.size),h=a.font?a.font:"Arial, Helvetica, sans-serif",f=a.fontweight?a.fontweight:"bold",g=Math.floor(u)+"x"+Math.floor(d),m=a.text?a.text:g;if("literal"==s.textmode){var o=s.dimensions;m=o.width+"x"+o.height}else if("exact"==s.textmode&&s.exact_dimensions){var o=s.exact_dimensions;m=Math.floor(o.width)+"x"+Math.floor(o.height)}var p={text:m,width:u,height:d,textHeight:c,font:h,fontWeight:f,template:a};if("canvas"==r.renderer?i=v(p):"svg"==r.renderer&&(i="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(x(p))))),null==i)throw"Holder: couldn't render placeholder";"background"==e?(n.style.backgroundImage="url("+i+")",n.style.backgroundSize=t.dimensions.width+"px "+t.dimensions.height+"px"):n.setAttribute("src",i),n.setAttribute("data-holder-rendered",!0)}function o(e,t,n,r,o){var s=n.dimensions,l=n.theme,c=n.text?decodeURIComponent(n.text):n.text,h=s.width+"x"+s.height,f={};c&&(f.text=c),n.font&&(f.font=n.font),l=d(l,f),"background"==e?null==t.getAttribute("data-background-src")&&t.setAttribute("data-background-src",r):t.setAttribute("data-src",r),n.theme=l,t.holderData={flags:n,instanceConfig:o},("image"==e||"fluid"==e)&&t.setAttribute("alt",c?c:l.text?l.text+" ["+h+"]":h),"image"==e?("html"!=o.renderer&&n.auto||(t.style.width=s.width+"px",t.style.height=s.height+"px"),"html"==o.renderer?t.style.backgroundColor=l.background:(i(e,{dimensions:s,theme:l,ratio:m.config.ratio,flags:n},t,o),n.textmode&&"exact"==n.textmode&&(m.runtime.resizableImages.push(t),a(t)))):"background"==e?"html"!=o.renderer&&i(e,{dimensions:s,theme:l,ratio:m.config.ratio,flags:n},t,o):"fluid"==e&&("%"==s.height.slice(-1)?t.style.height=s.height:null!=n.auto&&n.auto||(t.style.height=s.height+"px"),"%"==s.width.slice(-1)?t.style.width=s.width:null!=n.auto&&n.auto||(t.style.width=s.width+"px"),("inline"==t.style.display||""===t.style.display||"none"==t.style.display)&&(t.style.display="block"),u(t),"html"==o.renderer?t.style.backgroundColor=l.background:(m.runtime.resizableImages.push(t),a(t)))}function a(e){var t;t=null==e||null==e.nodeType?m.runtime.resizableImages:[e];for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];if(r.holderData){var o=r.holderData.flags,u=s(r,p.invisibleErrorFn(a));if(u){if(o.fluid){var l=r.holderData.fluidConfig;if(o.auto)switch(l.mode){case"width":u.height=u.width/l.ratio;break;case"height":u.width=u.height*l.ratio}}var d={dimensions:u,theme:o.theme,ratio:m.config.ratio,flags:o};o.textmode&&"exact"==o.textmode&&(o.exact_dimensions=u,d.dimensions=o.dimensions),i("image",d,r,r.holderData.instanceConfig)}}}}function s(e,t){var n={height:e.clientHeight,width:e.clientWidth};return n.height||n.width?(e.removeAttribute("data-holder-invisible"),n):(e.setAttribute("data-holder-invisible",!0),void t.call(this,e))}function u(e){if(e.holderData){var t=s(e,p.invisibleErrorFn(u));if(t){var n=e.holderData.flags,r={fluidHeight:"%"==n.dimensions.height.slice(-1),fluidWidth:"%"==n.dimensions.width.slice(-1),mode:null,initialDimensions:t};r.fluidWidth&&!r.fluidHeight?(r.mode="width",r.ratio=r.initialDimensions.width/parseFloat(n.dimensions.height)):!r.fluidWidth&&r.fluidHeight&&(r.mode="height",r.ratio=parseFloat(n.dimensions.width)/r.initialDimensions.height),e.holderData.fluidConfig=r}}}function l(e,t,n){t=parseInt(t,10),e=parseInt(e,10);var r=Math.max(t,e),i=Math.min(t,e),o=1/12,a=Math.min(.75*i,.75*r*o);return Math.round(Math.max(n,a))}function d(e,t){var n={};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function c(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+":"+e[n]);return t.join(";")}function h(e){m.runtime.debounceTimer||e.call(this),m.runtime.debounceTimer&&clearTimeout(m.runtime.debounceTimer),m.runtime.debounceTimer=setTimeout(function(){m.runtime.debounceTimer=null,e.call(this)},m.config.debounce)}function f(){h(function(){a(null)})}function g(e,t){var n=new Image;n.onerror=function(){t.call(this,!1,e)},n.onload=function(){t.call(this,!0,e)},n.src=e.src}var m={},p={addTheme:function(e,t){return null!=e&&null!=t&&(m.settings.themes[e]=t),this},addImage:function(e,t){var n=document.querySelectorAll(t);if(n.length)for(var r=0,i=n.length;i>r;r++){var o=document.createElement("img");o.setAttribute("data-src",e),n[r].appendChild(o)}return this},run:function(e){var i=d({},m.config);m.runtime.preempted=!0;var a=d(m.settings,e),s=[],u=[],l=[];for(a.use_canvas?i.renderer="canvas":a.use_svg&&(i.renderer="svg"),"string"==typeof a.images?u=document.querySelectorAll(a.images):t.NodeList&&a.images instanceof t.NodeList?u=a.images:t.Node&&a.images instanceof t.Node?u=[a.images]:t.HTMLCollection&&a.images instanceof t.HTMLCollection&&(u=a.images),"string"==typeof a.bgnodes?l=document.querySelectorAll(a.bgnodes):t.NodeList&&a.elements instanceof t.NodeList?l=a.bgnodes:t.Node&&a.bgnodes instanceof t.Node&&(l=[a.bgnodes]),f=0,h=u.length;h>f;f++)s.push(u[f]);for(var c=new RegExp(a.domain+'/(.*?)"?\\)'),h=l.length,f=0;h>f;f++){var p=t.getComputedStyle(l[f],null).getPropertyValue("background-image"),v=p.match(c),x=null;if(null==v){var y=l[f].getAttribute("data-background-src");null!=y&&(x=y)}else x=a.domain+"/"+v[1];if(null!=x){var b=r(x.split("/"),a);b&&o("background",l[f],b,x,i)}}for(h=s.length,f=0;h>f;f++){var w,S;S=w=src=null;var C=null,A=s[f];try{S=A.getAttribute("src"),w=A.getAttribute("data-src"),C=A.getAttribute("data-holder-rendered")}catch(E){}var k=null!=S,N=null!=w,D=N&&0===w.indexOf(a.domain),M=null!=C&&"true"==C;k?0===S.indexOf(a.domain)?n(a,i,S,A):D&&(M?n(a,i,w,A):g({src:S,options:a,instanceConfig:i,dataSrc:w,image:A},function(e,t){e||n(t.options,t.instanceConfig,t.dataSrc,t.image)})):D&&n(a,i,w,A)}return this},invisibleErrorFn:function(){return function(e){if(e.hasAttribute("data-holder-invisible"))throw"Holder: invisible placeholder"}}},v=(function(){{var e=document.createElement("canvas"),t=(e.getContext("2d"),"http://www.w3.org/2000/svg");document.createElementNS(t,"svg")}return function(){}}(),function(){var e=document.createElement("canvas"),t=e.getContext("2d");return function(n){return e.width=n.width,e.height=n.height,t.fillStyle=n.template.background,t.fillRect(0,0,n.width,n.height),t.textAlign="center",t.textBaseline="middle",t.font=n.fontWeight+" "+n.textHeight*m.config.ratio+"px "+n.font,t.fillStyle=n.template.foreground,t.fillText(n.text,n.width/2,n.height/2,n.width),e.toDataURL("image/png")}}()),x=function(){if(t.XMLSerializer){var e=new XMLSerializer,n="http://www.w3.org/2000/svg",r=document.createElementNS(n,"svg");r.webkitMatchesSelector&&r.setAttribute("xmlns","http://www.w3.org/2000/svg");var i="",o=document.createElementNS(n,"rect"),a=document.createElementNS(n,"text"),s=document.createTextNode(null);return a.setAttribute("text-anchor","middle"),a.appendChild(s),r.appendChild(o),r.appendChild(a),function(t){if(isNaN(t.width)||isNaN(t.height)||isNaN(t.textHeight))throw"Holder: incorrect properties passed to SVG constructor";return r.setAttribute("width",t.width),r.setAttribute("height",t.height),r.setAttribute("viewBox","0 0 "+t.width+" "+t.height),r.setAttribute("preserveAspectRatio","none"),o.setAttribute("width",t.width),o.setAttribute("height",t.height),o.setAttribute("fill",t.template.background),a.setAttribute("x",t.width/2),a.setAttribute("y",t.height/2),s.nodeValue=t.text,a.setAttribute("style",c({fill:t.template.foreground,"font-weight":t.fontWeight,"font-size":t.textHeight+"px","font-family":t.font,"dominant-baseline":"central"})),i+e.serializeToString(r)}}}();m.flags={dimensions:{regex:/^(\d+)x(\d+)$/,output:function(e){var t=this.regex.exec(e);return{width:+t[1],height:+t[2]}}},fluid:{regex:/^([0-9%]+)x([0-9%]+)$/,output:function(e){var t=this.regex.exec(e);return{width:t[1],height:t[2]}}},colors:{regex:/#([0-9a-f]{3,})\:#([0-9a-f]{3,})/i,output:function(e){var t=this.regex.exec(e);return{foreground:"#"+t[2],background:"#"+t[1]}}},text:{regex:/text\:(.*)/,output:function(e){return this.regex.exec(e)[1]}},font:{regex:/font\:(.*)/,output:function(e){return this.regex.exec(e)[1]}},auto:{regex:/^auto$/},textmode:{regex:/textmode\:(.*)/,output:function(e){return this.regex.exec(e)[1]}}};for(var y in m.flags)m.flags.hasOwnProperty(y)&&(m.flags[y].match=function(e){return e.match(this.regex)});m.settings={domain:"holder.js",images:"img",bgnodes:".holderjs",themes:{gray:{background:"#eee",foreground:"#aaa",size:12},social:{background:"#3a5a97",foreground:"#fff",size:12},industrial:{background:"#434A52",foreground:"#C2F200",size:12},sky:{background:"#0D8FDB",foreground:"#fff",size:12},vine:{background:"#39DBAC",foreground:"#1E292C",size:12},lava:{background:"#F8591A",foreground:"#1C2846",size:12}}},p.add_theme=p.addTheme,p.add_image=p.addImage,p.invisible_error_fn=p.invisibleErrorFn,m.config={renderer:"html",debounce:100,ratio:1},m.runtime={preempted:!1,resizableImages:[],debounceTimer:null},function(){var e=1,n=1,r=document.createElement("canvas"),i=null;r.getContext&&-1!=r.toDataURL("image/png").indexOf("data:image/png")&&(m.config.renderer="canvas",i=r.getContext("2d")),"canvas"==m.config.renderer&&(e=t.devicePixelRatio||1,n=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1),m.config.ratio=e/n,document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect&&(m.config.renderer="svg")}(),e(p,"Holder",t),t.onDomReady&&t.onDomReady(function(){m.runtime.preempted||p.run({}),t.addEventListener?(t.addEventListener("resize",f,!1),t.addEventListener("orientationchange",f,!1)):t.attachEvent("onresize",f),"object"==typeof t.Turbolinks&&t.document.addEventListener("page:change",function(){p.run({})})})}(function(e,t,n){var r="function"==typeof define&&define.amd;r?define(e):n[t]=e},this);