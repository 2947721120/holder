/*!

Holder - client side image placeholders
Version 2.4.0+8fril
Â© 2014 Ivan Malopinsky - http://imsky.co

Site:		http://imsky.github.io/holder
Issues:		https://github.com/imsky/holder/issues
License:	http://opensource.org/licenses/MIT

*/
!function(e,t,n){t[e]=n}("onDomReady",this,function(e){"use strict";function t(e){if(!y){if(!a.body)return r(t);for(y=!0;e=S.shift();)r(e)}}function n(e){(v||e.type===l||a[c]===h)&&(i(),t())}function i(){v?(a[x](p,n,s),e[x](l,n,s)):(a[m](w,n),e[m](u,n))}function r(e,t){setTimeout(e,+t>=0?t:1)}function o(e){y?r(e):S.push(e)}null==document.readyState&&document.addEventListener&&(document.addEventListener("DOMContentLoaded",function E(){document.removeEventListener("DOMContentLoaded",E,!1),document.readyState="complete"},!1),document.readyState="loading");var a=e.document,d=a.documentElement,l="load",s=!1,u="on"+l,h="complete",c="readyState",f="attachEvent",m="detachEvent",g="addEventListener",p="DOMContentLoaded",w="onreadystatechange",x="removeEventListener",v=g in a,b=s,y=s,S=[];if(a[c]===h)r(t);else if(v)a[g](p,n,s),e[g](l,n,s);else{a[f](w,n),e[f](u,n);try{b=null==e.frameElement&&d}catch(C){}b&&b.doScroll&&!function A(){if(!y){try{b.doScroll("left")}catch(e){return r(A,50)}i(),t()}}()}return o.version="1.4.0",o.isReady=function(){return y},o}(this)),document.querySelectorAll||(document.querySelectorAll=function(e){var t,n=document.createElement("style"),i=[];for(document.documentElement.firstChild.appendChild(n),document._qsa=[],n.styleSheet.cssText=e+"{x-qsa:expression(document._qsa && document._qsa.push(this))}",window.scrollBy(0,0),n.parentNode.removeChild(n);document._qsa.length;)t=document._qsa.shift(),t.style.removeAttribute("x-qsa"),i.push(t);return document._qsa=null,i}),document.querySelector||(document.querySelector=function(e){var t=document.querySelectorAll(e);return t.length?t[0]:null}),document.getElementsByClassName||(document.getElementsByClassName=function(e){return e=String(e).replace(/^|\s+/g,"."),document.querySelectorAll(e)}),function(e){var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";e.atob=e.atob||function(e){e=String(e);var n,i=0,r=[],o=0,a=0;if(e=e.replace(/\s/g,""),e.length%4===0&&(e=e.replace(/=+$/,"")),e.length%4===1)throw Error("InvalidCharacterError");if(/[^+/0-9A-Za-z]/.test(e))throw Error("InvalidCharacterError");for(;i<e.length;)n=t.indexOf(e.charAt(i)),o=o<<6|n,a+=6,24===a&&(r.push(String.fromCharCode(o>>16&255)),r.push(String.fromCharCode(o>>8&255)),r.push(String.fromCharCode(255&o)),a=0,o=0),i+=1;return 12===a?(o>>=4,r.push(String.fromCharCode(255&o))):18===a&&(o>>=2,r.push(String.fromCharCode(o>>8&255)),r.push(String.fromCharCode(255&o))),r.join("")},e.btoa=e.btoa||function(e){e=String(e);var n,i,r,o,a,d,l,s=0,u=[];if(/[^\x00-\xFF]/.test(e))throw Error("InvalidCharacterError");for(;s<e.length;)n=e.charCodeAt(s++),i=e.charCodeAt(s++),r=e.charCodeAt(s++),o=n>>2,a=(3&n)<<4|i>>4,d=(15&i)<<2|r>>6,l=63&r,s===e.length+2?(d=64,l=64):s===e.length+1&&(l=64),u.push(t.charAt(o),t.charAt(a),t.charAt(d),t.charAt(l));return u.join("")}}(this),function(){function e(t,n,i){t.document;var r,o=t.currentStyle[n].match(/([\d\.]+)(%|cm|em|in|mm|pc|pt|)/)||[0,0,""],a=o[1],d=o[2];return i=i?/%|em/.test(d)&&t.parentElement?e(t.parentElement,"fontSize",null):16:i,r="fontSize"==n?i:/width/i.test(n)?t.clientWidth:t.clientHeight,"%"==d?a/100*r:"cm"==d?.3937*a*96:"em"==d?a*i:"in"==d?96*a:"mm"==d?.3937*a*96/10:"pc"==d?12*a*96/72:"pt"==d?96*a/72:a}function t(e,t){var n="border"==t?"Width":"",i=t+"Top"+n,r=t+"Right"+n,o=t+"Bottom"+n,a=t+"Left"+n;e[t]=(e[i]==e[r]&&e[i]==e[o]&&e[i]==e[a]?[e[i]]:e[i]==e[o]&&e[a]==e[r]?[e[i],e[r]]:e[a]==e[r]?[e[i],e[r],e[o]]:[e[i],e[r],e[o],e[a]]).join(" ")}function n(n){var i,r=this,o=n.currentStyle,a=e(n,"fontSize"),d=function(e){return"-"+e.toLowerCase()};for(i in o)if(Array.prototype.push.call(r,"styleFloat"==i?"float":i.replace(/[A-Z]/,d)),"width"==i)r[i]=n.offsetWidth+"px";else if("height"==i)r[i]=n.offsetHeight+"px";else if("styleFloat"==i)r.float=o[i];else if(/margin.|padding.|border.+W/.test(i)&&"auto"!=r[i])r[i]=Math.round(e(n,i,a))+"px";else if(/^outline/.test(i))try{r[i]=o[i]}catch(l){r.outlineColor=o.color,r.outlineStyle=r.outlineStyle||"none",r.outlineWidth=r.outlineWidth||"0px",r.outline=[r.outlineColor,r.outlineWidth,r.outlineStyle].join(" ")}else r[i]=o[i];t(r,"margin"),t(r,"padding"),t(r,"border"),r.fontSize=Math.round(a)+"px"}window.getComputedStyle||(n.prototype={constructor:n,getPropertyPriority:function(){throw new Error("NotSupportedError: DOM Exception 9")},getPropertyValue:function(e){return this[e.replace(/-\w/g,function(e){return e[1].toUpperCase()})]},item:function(e){return this[e]},removeProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},setProperty:function(){throw new Error("NoModificationAllowedError: DOM Exception 7")},getPropertyCSSValue:function(){throw new Error("NotSupportedError: DOM Exception 9")}},window.getComputedStyle=Window.prototype.getComputedStyle=function(e){return new n(e)})}(),Object.prototype.hasOwnProperty||(Object.prototype.hasOwnProperty=function(e){var t=this.__proto__||this.constructor.prototype;return e in this&&(!(e in t)||t[e]!==this[e])}),function(e,t){function n(e,t){for(var n={theme:s(f.settings.themes.gray,{})},i=!1,r=e.length,o=0;r>o;o++){var a=e[o];if(f.flags.dimensions.match(a))i=!0,n.dimensions=f.flags.dimensions.output(a);else if(f.flags.fluid.match(a))i=!0,n.dimensions=f.flags.fluid.output(a),n.fluid=!0;else if(f.flags.textmode.match(a))n.textmode=f.flags.textmode.output(a);else if(f.flags.colors.match(a)){var d=f.flags.colors.output(a);n.theme=s(d,n.theme)}else t.themes[a]?t.themes.hasOwnProperty(a)&&(n.theme=s(t.themes[a],{})):f.flags.font.match(a)?n.font=f.flags.font.output(a):f.flags.auto.match(a)?n.auto=!0:f.flags.text.match(a)&&(n.text=f.flags.text.output(a))}return i?n:!1}function i(e,t,n){t=parseInt(t,10),e=parseInt(e,10);var i=Math.max(t,e),r=Math.min(t,e),o=1/12,a=Math.min(.75*r,.75*i*o);return Math.round(Math.max(n,a))}function r(e,t,n,r){var o=null,a=t.dimensions,d=t.template,l=t.holder,s=a.width,u=a.height,h=i(s,u,d.size),c=d.font?d.font:"Arial, Helvetica, sans-serif",f=d.fontweight?d.fontweight:"bold",m=Math.floor(s)+"x"+Math.floor(u),w=d.text?d.text:m;if("literal"==l.textmode){var a=l.dimensions;w=a.width+"x"+a.height}else if("exact"==l.textmode&&l.exact_dimensions){var a=l.exact_dimensions;w=Math.floor(a.width)+"x"+Math.floor(a.height)}var x={text:w,width:s,height:u,text_height:h,font:c,font_weight:f,template:d};if("canvas"==r.renderer?o=g(x):"svg"==r.renderer&&(o="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(p(x))))),null==o)throw"Holder: couldn't render placeholder";"background"==e?(n.style.backgroundImage="url("+o+")",n.style.backgroundSize=t.dimensions.width+"px "+t.dimensions.height+"px"):n.setAttribute("src",o),n.setAttribute("data-holder-rendered",!0)}function o(e,t,n,i,o){var d=n.dimensions,u=n.theme,h=n.text?decodeURIComponent(n.text):n.text,c=d.width+"x"+d.height;u=h?s(u,{text:h}):u,u=n.font?s(u,{font:n.font}):u,t.setAttribute("data-src",i),n.theme=u,t.holderData=n,t.configData=o,"image"==e?(t.setAttribute("alt",h?h:u.text?u.text+" ["+c+"]":c),"html"!=o.renderer&&n.auto||(t.style.width=d.width+"px",t.style.height=d.height+"px"),"html"==o.renderer?t.style.backgroundColor=u.background:(r(e,{dimensions:d,template:u,ratio:f.config.ratio,holder:n},t,o),n.textmode&&"exact"==n.textmode&&(f.runtime.resizableImages.push(t),a(t)))):"background"==e?"html"!=o.renderer&&r(e,{dimensions:d,template:u,ratio:f.config.ratio,holder:n},t,o):"fluid"==e&&(t.setAttribute("alt",h?h:u.text?u.text+" ["+c+"]":c),"%"==d.height.slice(-1)?t.style.height=d.height:null!=n.auto&&n.auto||(t.style.height=d.height+"px"),"%"==d.width.slice(-1)?t.style.width=d.width:null!=n.auto&&n.auto||(t.style.width=d.width+"px"),("inline"==t.style.display||""===t.style.display||"none"==t.style.display)&&(t.style.display="block"),l(t),"html"==o.renderer?t.style.backgroundColor=u.background:(f.runtime.resizableImages.push(t),a(t)))}function a(e){var t;t=null==e||null==e.nodeType?f.runtime.resizableImages:[e];for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i.holderData){var o=i.holderData,l=d(i,m.invisibleErrorFn(a));if(l){if(o.fluid&&o.auto)switch(o.fluid_data.mode){case"width":l.height=l.width/o.fluid_data.ratio;break;case"height":l.width=l.height*o.fluid_data.ratio}var s={dimensions:l,template:o.theme,ratio:f.config.ratio,holder:o};o.textmode&&"exact"==o.textmode&&(o.exact_dimensions=l,s.dimensions=o.dimensions),r("image",s,i,i.configData)}}}}function d(e,t){var n={height:e.clientHeight,width:e.clientWidth};return n.height||n.width?(e.removeAttribute("data-holder-invisible"),n):(e.setAttribute("data-holder-invisible",!0),void t.call(this,e))}function l(e){if(e.holderData){var t=d(e,m.invisibleErrorFn(l));if(t){var n=e.holderData;n.initial_dimensions=t,n.fluid_data={fluid_height:"%"==n.dimensions.height.slice(-1),fluid_width:"%"==n.dimensions.width.slice(-1),mode:null},n.fluid_data.fluid_width&&!n.fluid_data.fluid_height?(n.fluid_data.mode="width",n.fluid_data.ratio=n.initial_dimensions.width/parseFloat(n.dimensions.height)):!n.fluid_data.fluid_width&&n.fluid_data.fluid_height&&(n.fluid_data.mode="height",n.fluid_data.ratio=parseFloat(n.dimensions.width)/n.initial_dimensions.height)}}}function s(e,t){var n={};for(var i in e)e.hasOwnProperty(i)&&(n[i]=e[i]);for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);return n}function u(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n+":"+e[n]);return t.join(";")}function h(e){f.runtime.debounceTimer||e.call(this),f.runtime.debounceTimer&&clearTimeout(f.runtime.debounceTimer),f.runtime.debounceTimer=setTimeout(function(){f.runtime.debounceTimer=null,e.call(this)},f.config.debounce)}function c(){h(function(){a(null)})}var f={},m={addTheme:function(e,t){return null!=e&&null!=t&&(f.settings.themes[e]=t),this},addImage:function(e,t){var n=document.querySelectorAll(t);if(n.length)for(var i=0,r=n.length;r>i;i++){var o=document.createElement("img");o.setAttribute("data-src",e),n[i].appendChild(o)}return this},run:function(e){var t=s({},f.config);f.runtime.preempted=!0;var i=s(f.settings,e),r=[],a=[],d=[];for(i.use_canvas?t.renderer="canvas":i.use_svg&&(t.renderer="svg"),"string"==typeof i.images?a=document.querySelectorAll(i.images):window.NodeList&&i.images instanceof window.NodeList?a=i.images:window.Node&&i.images instanceof window.Node?a=[i.images]:window.HTMLCollection&&i.images instanceof window.HTMLCollection&&(a=i.images),"string"==typeof i.bgnodes?d=document.querySelectorAll(i.bgnodes):window.NodeList&&i.elements instanceof window.NodeList?d=i.bgnodes:window.Node&&i.bgnodes instanceof window.Node&&(d=[i.bgnodes]),h=0,u=a.length;u>h;h++)r.push(a[h]);for(var l=new RegExp(i.domain+'/(.*?)"?\\)'),u=d.length,h=0;u>h;h++){var c=window.getComputedStyle(d[h],null).getPropertyValue("background-image"),m=c.match(l),g=d[h].getAttribute("data-background-src");if(m){var p=n(m[1].split("/"),i);p&&o("background",d[h],p,c,t)}else if(null!=g){var p=n(g.substr(g.lastIndexOf(i.domain)+i.domain.length+1).split("/"),i);p&&o("background",d[h],p,c,t)}}for(u=r.length,h=0;u>h;h++){var w,x;x=w=c=null;try{x=r[h].getAttribute("src"),attr_datasrc=r[h].getAttribute("data-src")}catch(v){}if(null==attr_datasrc&&x&&x.indexOf(i.domain)>=0?c=x:attr_datasrc&&attr_datasrc.indexOf(i.domain)>=0&&(c=attr_datasrc),c){var p=n(c.substr(c.lastIndexOf(i.domain)+i.domain.length+1).split("/"),i);p&&(p.fluid?o("fluid",r[h],p,c,t):o("image",r[h],p,c,t))}}return this},invisibleErrorFn:function(){return function(e){if(e.hasAttribute("data-holder-invisible"))throw"Holder: invisible placeholder"}}},g=function(){var e=document.createElement("canvas"),t=e.getContext("2d");return function(n){return e.width=n.width,e.height=n.height,t.fillStyle=n.template.background,t.fillRect(0,0,n.width,n.height),t.textAlign="center",t.textBaseline="middle",t.font=n.font_weight+" "+n.text_height*f.config.ratio+"px "+n.font,t.fillStyle=n.template.foreground,t.fillText(n.text,n.width/2,n.height/2,n.width),e.toDataURL("image/png")}}(),p=function(){if(window.XMLSerializer){var e=new XMLSerializer,t="http://www.w3.org/2000/svg",n=document.createElementNS(t,"svg");n.webkitMatchesSelector&&n.setAttribute("xmlns","http://www.w3.org/2000/svg");var i="",r=document.createElementNS(t,"rect"),o=document.createElementNS(t,"text"),a=document.createTextNode(null);return o.setAttribute("text-anchor","middle"),o.appendChild(a),n.appendChild(r),n.appendChild(o),function(t){if(isNaN(t.width)||isNaN(t.height)||isNaN(t.text_height))throw"Holder: incorrect properties passed to SVG constructor";return n.setAttribute("width",t.width),n.setAttribute("height",t.height),n.setAttribute("viewBox","0 0 "+t.width+" "+t.height),n.setAttribute("preserveAspectRatio","none"),r.setAttribute("width",t.width),r.setAttribute("height",t.height),r.setAttribute("fill",t.template.background),o.setAttribute("x",t.width/2),o.setAttribute("y",t.height/2),a.nodeValue=t.text,o.setAttribute("style",u({fill:t.template.foreground,"font-weight":t.font_weight,"font-size":t.text_height+"px","font-family":t.font,"dominant-baseline":"central"})),i+e.serializeToString(n)}}}();f.flags={dimensions:{regex:/^(\d+)x(\d+)$/,output:function(e){var t=this.regex.exec(e);return{width:+t[1],height:+t[2]}}},fluid:{regex:/^([0-9%]+)x([0-9%]+)$/,output:function(e){var t=this.regex.exec(e);return{width:t[1],height:t[2]}}},colors:{regex:/#([0-9a-f]{3,})\:#([0-9a-f]{3,})/i,output:function(e){var t=this.regex.exec(e);return{foreground:"#"+t[2],background:"#"+t[1]}}},text:{regex:/text\:(.*)/,output:function(e){return this.regex.exec(e)[1]}},font:{regex:/font\:(.*)/,output:function(e){return this.regex.exec(e)[1]}},auto:{regex:/^auto$/},textmode:{regex:/textmode\:(.*)/,output:function(e){return this.regex.exec(e)[1]}}};for(var w in f.flags)f.flags.hasOwnProperty(w)&&(f.flags[w].match=function(e){return e.match(this.regex)});f.settings={domain:"holder.js",images:"img",bgnodes:".holderjs",themes:{gray:{background:"#eee",foreground:"#aaa",size:12},social:{background:"#3a5a97",foreground:"#fff",size:12},industrial:{background:"#434A52",foreground:"#C2F200",size:12},sky:{background:"#0D8FDB",foreground:"#fff",size:12},vine:{background:"#39DBAC",foreground:"#1E292C",size:12},lava:{background:"#F8591A",foreground:"#1C2846",size:12}}},m.add_theme=m.addTheme,m.add_image=m.addImage,m.invisible_error_fn=m.invisibleErrorFn,f.config={renderer:"html",debounce:100,ratio:1},f.runtime={preempted:!1,resizableImages:[],debounceTimer:null},function(){var e=1,t=1,n=document.createElement("canvas"),i=null;n.getContext&&-1!=n.toDataURL("image/png").indexOf("data:image/png")&&(f.config.renderer="canvas",i=n.getContext("2d")),"canvas"==f.config.renderer&&(e=window.devicePixelRatio||1,t=i.webkitBackingStorePixelRatio||i.mozBackingStorePixelRatio||i.msBackingStorePixelRatio||i.oBackingStorePixelRatio||i.backingStorePixelRatio||1),f.config.ratio=e/t,document.createElementNS&&document.createElementNS("http://www.w3.org/2000/svg","svg").createSVGRect&&(f.config.renderer="svg")}(),e(m,"Holder",t),t.onDomReady&&t.onDomReady(function(){f.runtime.preempted||m.run({}),t.addEventListener?(t.addEventListener("resize",c,!1),t.addEventListener("orientationchange",c,!1)):t.attachEvent("onresize",c),"object"==typeof t.Turbolinks&&t.document.addEventListener("page:change",function(){m.run({})})})}(function(e,t,n){var i="function"==typeof define&&define.amd;i?define(e):n[t]=e},this);